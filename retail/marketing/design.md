# 营销设计

## 业务

* 营销类型：
  * 固态活动（团购&抢购）：所有人都可以参加；初始销售价格优惠；
  * 动态活动（满减活动）：所有人都可以参加；结算金额优惠；
  * 优惠券（满减券，折扣券）：有优惠券（凭证）才可以参加；结算金额优惠；
  * 积分：
* 固态内是排他的，固态和其他形态也是排他的
* 业务层面，商品只能参加单个活动。表结构支持商品参加多个活动。
* 活动要有时间范围
* 营销工具对应平台活动(可以有多个)和商户活动。
动态活动商品表：

| 活动 | 排它 |描述|
|:--------:|:-------:|:--------:|
|满减|Y|满300，减５０|
|满送|Y|满300，送你商品Ａ|
|第二件半价|Y||
|满三件八折|Y||
|换购|N|购买商品A，便宜卖给你商品B|
|买送|Y|买商品A，免费送你商品B|

## 模块

### 抢购&团购

  * 用户参加抢购团购的次数可配，目前是一次。

### 优惠券

  * 商家和平台都可以发布券。
  * 商家券的使用范围由商家指定。平台券全场通用。
  * 一笔订单，只能使用一张优惠券。
  * 优惠券的面值，不大于订单的总金额。优惠券有使用门槛。
  * 一个用户，使用同一优惠券的次数可配，目前是一次。

### 满减活动

* 活动阶梯优惠：
  * 比如，一个满减活动。满100减10，满200减120。满300减180。这三个组成优惠规则。
  * 订单只能参加活动中的一个优惠。参加满200减120的，就不能参加满100减10
  * 活动商品下单，商品id和活动id都要提交到后端。
* 优惠规则结构：
```
Activity:
  {
    "activityId": "123",
    "createtime": 2017-05-19 00:00:00,
    "promos": [
        {
            "name": "满99减50",
            "condition": 99,
            "discount": 50
        },
        {
            "name": "满159减80",
            "condition": 159,
            "discount": 80
        },
        {
            "name": "满199减110",
            "condition": 199,
            "discount": 110
        }
    ]
  }
```

### 发布营销活动

发布团购&抢购&满减活动
  * 设置活动时间，活动商品，数量，价格。
  * 设置营销规则
  * 提交平台审核。
发布优惠券：
  * 设置优惠券面值，使用门槛，使用时间等基本信息
  * 选择优惠券的优惠商品
  * 参加平台的优惠券活动
  * 发布成功

### 参与营销活动

参加团购&抢购&满减活动：
  * 选择商品，购买，自动就参加了。
参加优惠券活动：
  * 在领券中心领取优惠券
  * 商家扫优惠券码，使用成功

### 营销活动结算

#### 活动（抢购，团购，满减等）：

    由商家承担优惠金额

#### 优惠券：

  * 优惠券是在结算的时候生效。仅针对参加优惠的商品，进行优惠。
  * 订单中有10个商品，有5个商品参与了优惠券活动。由这5个商品按照金额比例承担优惠金额
  * 一个订单有三件商品，商品A：60元，商品B:40元，商品C:50。使用一张满130减30的优惠券。
    * 商品A实际支付为：(60/(60+40+50))*(150-30)=48元,
    * 商品B实际支付为：(40/(60+40+50))*（150-30）=31.99元,
    * 商品C实际支付为：120-48-31.99=40.01。
  * 优惠券实际也是一个满减活动。这个结算规则，同时适用于满减活动。
  * 一个订单，一种优惠，记录一条OrderPromotion。优惠结果存json。
  * 一个订单，可以使用多种优惠券（由优惠券是否可叠加使用决定）。
  * 优惠券分摊，只针对商家发布的券。

#### 积分：按照实际的支付金额，给与比例的积分。

  * 支付一元，返回一个积分。
  * 发生退款，按照退款金额，扣除相应的积分。

#### 退款：

  * 参与优惠活动的订单发生退款，退还实际支付的金额。
  * 优惠券订单，全单退款，可退还优惠券。部分退款，不退优惠券。
  * 退款金额，根据订单（Order）和订单优惠（OrderPromotion）计算得出。

#### 优惠承担规则:

| 营销类型 | 运营方 | 优惠承担和退款 |
|:--------:|:--------:|:--------:|
|平台优惠券|平台|整单|
|商家优惠券|商家|优惠商品金额比例|
|平台活动|平台|整单|
|商家活动|商家|优惠商品金额比例|

# 新整理
## 理解
1. 营销活动
  1. 有活动时间范围(不是使用的有效时间范围)
  1. 除了优惠券/卡等实物类的，其他营销都是活动
  1. 活动集合页面不是活动
1. 优惠券通过微信卡包发布，支持核销

## 有赞营销
| 类型 | 项 | 说明 | 教程 |
| :----: | ---- | ---- |
| 营销 | **会员价** |  | https://help.youzan.com/qa?cat_sys=K#/menu/2111/detail/1092 |
| 营销 | **满减/送** |  | https://help.youzan.com/qa#/menu/2186/detail/325 |
| 营销 | **优惠券** |  | https://help.youzan.com/qa#/menu/2185/detail/915 |
| 营销 | 秒杀 |  | https://help.youzan.com/qa#/menu/2199/detail/1011 |
| 营销 | 限时折扣 |  | https://help.youzan.com/qa#/menu/2189/detail/919 |
| 营销 | 优惠码 |  | https://help.youzan.com/qa#/menu/2185/detail/917 |
| 玩法 | **发券宝** |  | https://bbs.youzan.com/thread-632147-1-1.html |
| 玩法 | **多人拼团** |  | https://help.youzan.com/qa#/menu/2196/category/all/order/all/page/1 |
| 卡 | **会员卡** |  | https://help.youzan.com/qa#/menu/3013/category/all/order/all/page/1 |
| 卡 | 礼品卡 |  | https://help.youzan.com/qa?cat_sys=K#/menu/3259/detail/2689 |
